stateDiagram-v2
[*] --> Idle
Idle --> TextReceived: User submits text query
TextReceived --> Validating: Validate input format
Validating --> DatabaseSearch: Query internal DB
DatabaseSearch --> CrossReferencing: Check fatwa/sources
CrossReferencing --> DecisionPoint: Evaluate compliance

    state DecisionPoint {
        [*] --> Checking
        Checking --> Halal: No violations
        Checking --> Haram: Violations found
    }

    Halal --> ResponseGeneration: Create conditional approval
    Haram --> ResponseGeneration: Create rejection report
    ResponseGeneration --> HistorySaved: Store analysis
    HistorySaved --> FollowUp: Present options
    FollowUp --> Timeout: No response for 5min
    FollowUp --> DetailView: User selects option
    DetailView --> HistorySaved
    Timeout --> Idle
